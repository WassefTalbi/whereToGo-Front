<div class="col-lg-auto">
  
  <button type="button" class="btn btn-primary add-btn ms-1" (click)="showModal?.show()">
    <i class="bi bi-plus-circle align-baseline me-1"></i> Ajouter Post
    </button>
</div>
<section style="background-color: #f1e6e6;">
    <div class="container my-5 py-5">
      <h2 class="mb-0">Recent Posts</h2>
      <div class="row d-flex justify-content-center">
        <div class="col-md-12 col-lg-10">
          
          <div class="card text-body" *ngFor="let post of posts; let i = index">
            <div class="card-body p-4">
              
              <p class="fw-light mb-4 pb-2">Latest posts section by {{post.student}}</p>
  
              <div class="d-flex flex-start">
                <img class="rounded-circle shadow-1-strong me-3"
                [src]="'*' + post.photoProfile" alt="avatar" width="60" height="60" />
                <div>
                  <h6 class="fw-bold mb-1">{{post.student}}</h6>
                  <div class="d-flex align-items-center mb-3 position-relative">
                    <p class="mb-0">
                      {{post.datePost}}
                      <span *ngIf="post.postStatus === 'PENDING'" class="badge bg-primary">{{post.postStatus}}</span>
                      <span *ngIf="post.postStatus === 'APPROVED'" class="badge bg-success">{{post.postStatus}}</span>
                      <span *ngIf="post.postStatus === 'REJECTED'" class="badge bg-danger">{{post.postStatus}}</span>
                    </p>
                    <a (click)="toggleDropdown(i)" class="link-muted ms-2 position-relative">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
                      </svg>
                      <div *ngIf="dropdownOpenIndex === i" class="dropdown-menu show" style="position: absolute; top: 100%; left: 0;">
                        <a class="dropdown-item" (click)="changeStatus(post, 'PENDING')">Pending</a>
                        <a class="dropdown-item" (click)="changeStatus(post, 'APPROVED')">Approved</a>
                        <a class="dropdown-item" (click)="changeStatus(post, 'REJECTED')">Rejected</a>
                      </div>
                    </a>
                  </div>
                  <p class="mb-0">
                    {{ post.content }}
                  </p>
                </div>
              </div>
            </div>
  
            <hr class="my-0" />
          </div>
        </div>
      </div>
    </div>
  </section>
  <div bsModal #showModal="bs-modal" class="modal fade" id="showModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header px-4 pt-4">
                <h5 class="modal-title" id="exampleModalLabel">Ajouter une Post</h5>
                <button type="button" class="btn-close" (click)="showModal.hide()"></button>
            </div>
  
            <form (ngSubmit)="addPost()" [formGroup]="postForm" class="tablelist-form" novalidate autocomplete="off">
                <div class="modal-body p-4">
                    <div id="alert-error-msg" class="d-none alert alert-danger py-2"></div>
  
                   
  
                    <div class="mb-3">
                        <label for="post-content-input" class="form-label">Content</label>
                        <textarea id="post-content-input" formControlName="content" class="form-control" rows="3" placeholder="Entrez le content" required></textarea>
                        <div *ngIf="content?.invalid && (content?.dirty || content?.touched)" class="error-message">
                          <small *ngIf="content?.errors?.['required']">Content is required and cannot be blank.</small>
                          <small *ngIf="content?.errors?.['minlength']">Content must be at least 12 characters long.</small>
                          <small *ngIf="content?.errors?.['maxlength']">Content cannot be more than 255 characters long.</small>
                        </div>
                    </div>
  
                </div>
                <div class="modal-footer">
                    <div class="hstack gap-2 justify-content-end">
                        <button type="button" class="btn btn-ghost-danger" (click)="showModal.hide()">
                            <i class="bi bi-x-lg align-baseline me-1"></i> Fermer
                        </button>
                        <button type="submit" class="btn btn-primary" id="add-btn">Ajouter Post</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
  </div>  